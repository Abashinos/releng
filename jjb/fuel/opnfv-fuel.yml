########################
# Job configuration for fuel
########################
- project:

    name: 'opnfv-fuel'

    installer: 'fuel'

    controller:
        - 'odl'
        - 'onos'
        - 'opencontrail'

    pod:
        - 'opnfv-jump-2'
        - 'ericsson-pod1'

    loop:
        - 'daily'

    stream:
        - master:
            branch: 'master'
            gs-pathname: ''

    jobs:
        - 'opnfv-fuel-{controller}-{pod}-{loop}-{stream}'
        - 'opnfv-fuel-deploy-{pod}-{loop}-{stream}'

########################
# job templates
########################
- job-template:
    name: 'opnfv-fuel-{controller}-{pod}-{loop}-{stream}'

    disabled: true

    concurrent: false

    parameters:
        - project-parameter:
            project: '{installer}'
        - 'ericsson-ca-build-1-defaults'
        - '{installer}-defaults':
            controller: '{controller}'

    scm:
        - git-scm:
            credentials-id: '{ssh-credentials}'
            refspec: ''
            branch: '{branch}'

    builders:
        - trigger-builds:
          - project: 'opnfv-fuel-daily-deploy-{stream}'
            git-revision: true
            block: true
            predefined-parameters:
                CONTROLLER={controller}

- job-template:
    name: 'opnfv-fuel-deploy-{pod}-{loop}-{stream}'

    disabled: true

    concurrent: false

    wrappers:
        - build-name:
            name: '$BUILD_NUMBER: {installer} $CONTROLLER'

    parameters:
        - project-parameter:
            project: '{installer}'
        - '{pod}-defaults':
            loop: '{loop}'
        - '{installer}-defaults'

    scm:
        - git-scm:
            credentials-id: '{ssh-credentials}'
            refspec: ''
            branch: '{branch}'

    builders:
        - shell: |
            #!/bin/bash
            echo "Hello World from OPNFV $INSTALLER_NAME"
            echo "Running $INSTALLER_NAME with controller $CONTROLLER"
